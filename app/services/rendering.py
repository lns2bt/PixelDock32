FONT_5X7 = {
    " ": ["00000", "00000", "00000", "00000", "00000", "00000", "00000"],
    ":": ["00000", "00100", "00000", "00000", "00100", "00000", "00000"],
    ".": ["00000", "00000", "00000", "00000", "00000", "00100", "00000"],
    "-": ["00000", "00000", "00000", "01110", "00000", "00000", "00000"],
    "0": ["01110", "10001", "10011", "10101", "11001", "10001", "01110"],
    "1": ["00100", "01100", "00100", "00100", "00100", "00100", "01110"],
    "2": ["01110", "10001", "00001", "00010", "00100", "01000", "11111"],
    "3": ["11110", "00001", "00001", "01110", "00001", "00001", "11110"],
    "4": ["00010", "00110", "01010", "10010", "11111", "00010", "00010"],
    "5": ["11111", "10000", "10000", "11110", "00001", "00001", "11110"],
    "6": ["00110", "01000", "10000", "11110", "10001", "10001", "01110"],
    "7": ["11111", "00001", "00010", "00100", "01000", "10000", "10000"],
    "8": ["01110", "10001", "10001", "01110", "10001", "10001", "01110"],
    "9": ["01110", "10001", "10001", "01111", "00001", "00010", "11100"],
    "A": ["01110", "10001", "10001", "11111", "10001", "10001", "10001"],
    "B": ["11110", "10001", "10001", "11110", "10001", "10001", "11110"],
    "C": ["01110", "10001", "10000", "10000", "10000", "10001", "01110"],
    "E": ["11111", "10000", "10000", "11110", "10000", "10000", "11111"],
    "F": ["11111", "10000", "10000", "11110", "10000", "10000", "10000"],
    "H": ["10001", "10001", "10001", "11111", "10001", "10001", "10001"],
    "I": ["01110", "00100", "00100", "00100", "00100", "00100", "01110"],
    "K": ["10001", "10010", "10100", "11000", "10100", "10010", "10001"],
    "N": ["10001", "11001", "10101", "10011", "10001", "10001", "10001"],
    "O": ["01110", "10001", "10001", "10001", "10001", "10001", "01110"],
    "P": ["11110", "10001", "10001", "11110", "10000", "10000", "10000"],
    "R": ["11110", "10001", "10001", "11110", "10100", "10010", "10001"],
    "S": ["01111", "10000", "10000", "01110", "00001", "00001", "11110"],
    "T": ["11111", "00100", "00100", "00100", "00100", "00100", "00100"],
    "U": ["10001", "10001", "10001", "10001", "10001", "10001", "01110"],
    "W": ["10001", "10001", "10001", "10101", "10101", "10101", "01010"],
    "â‚¬": ["01111", "10000", "11110", "10000", "11110", "10000", "01111"],
}


def blank_frame(width: int = 32, height: int = 8) -> list[list[int]]:
    return [[0 for _ in range(width)] for _ in range(height)]


def blank_color_frame(width: int = 32, height: int = 8) -> list[list[tuple[int, int, int] | None]]:
    return [[None for _ in range(width)] for _ in range(height)]


def render_text_frame(text: str, width: int = 32, height: int = 8) -> list[list[int]]:
    frame, _ = render_text_with_colors(text=text, width=width, height=height)
    return frame


def render_text_with_colors(
    text: str,
    char_colors: list[tuple[int, int, int]] | None = None,
    width: int = 32,
    height: int = 8,
) -> tuple[list[list[int]], list[list[tuple[int, int, int] | None]]]:
    frame = blank_frame(width, height)
    color_frame = blank_color_frame(width, height)
    x_cursor = 0
    upper = text.upper()[:8]

    for idx, char in enumerate(upper):
        glyph = FONT_5X7.get(char, FONT_5X7[" "])
        color = (80, 80, 80)
        if char_colors and idx < len(char_colors):
            color = char_colors[idx]

        for y, row in enumerate(glyph):
            for x, pixel in enumerate(row):
                out_y = y + 1
                out_x = x_cursor + x
                if out_y < height and out_x < width and pixel == "1":
                    frame[out_y][out_x] = 1
                    color_frame[out_y][out_x] = color

        x_cursor += 6
        if x_cursor >= width:
            break

    return frame, color_frame
